# 店铺模块设计文档

## 一、概述

### 1.1 模块简介

店铺模块是 SaaS Mall 系统的核心模块之一，负责管理店铺及其关联关系。支持单店和连锁品牌两种业务模式。

### 1.2 核心功能

- 店铺管理（单店、连锁总部、连锁分店）
- 用户店铺关联管理
- 店铺切换功能
- 数据权限控制

### 1.3 业务模式

#### 单店模式
- 独立经营的单个店铺
- 自己管理商品和库存
- 数据完全隔离

#### 连锁模式
- 两级结构：总部 → 分店
- 总部统一管理商品，分店可修改价格和上下架状态
- 总部可见所有分店数据，分店只能看自己

---

## 二、需求总结

### 2.1 核心需求

| 需求项 | 说明 |
|--------|------|
| 店铺类型 | 单店、连锁总部、连锁分店 |
| 层级结构 | 两级（总部 → 分店） |
| 数据隔离 | 通过 parent_id 实现数据隔离 |
| 用户权限 | 用户可以管理多个店铺 |
| 数据可见性 | 总部可见所有分店，分店只能看自己 |

### 2.2 业务规则

| 规则项 | 说明 |
|--------|------|
| 店铺注册 | 支持商户自助注册 |
| 店铺编码 | 系统自动生成（格式：SHOP20250120001） |
| 用户关联 | 创建店铺时自动关联创建人 |
| 删除方式 | 逻辑删除（is_deleted 字段） |
| 营业时间 | 简单模式（09:00-21:00） |

---

## 三、技术架构

### 3.1 技术栈

- **后端框架**: Spring Boot 3.x
- **数据库**: MySQL 8.0
- **ORM**: MyBatis
- **服务调用**: Dubbo
- **前端框架**: React + Ant Design Pro

### 3.2 模块结构

```
mall-service-shop
├── entity/          # 实体类
├── mapper/          # MyBatis Mapper
├── inner/           # 内部服务（直接操作 Mapper）
├── service/impl/    # Dubbo 服务实现
└── enums/           # 枚举类

mall-api-shop
├── dto/             # 数据传输对象
└── ShopService.java # Dubbo 服务接口
```

---

## 四、相关文档

- [数据库设计文档](./DATABASE_DESIGN.md)
- [接口设计文档](./API_DESIGN.md)
- [前端页面设计](./FRONTEND_DESIGN.md)

---

## 五、版本历史

| 版本 | 日期 | 作者 | 说明 |
|------|------|------|------|
| v1.0 | 2025-01-20 | OpenCode | 初始版本 |
| v2.0 | 2025-01-20 | OpenCode | 移除 Tenant 模块，简化架构 |
